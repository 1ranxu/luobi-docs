# LuoBI

## é¡¹ç›®ä»‹ç»

**BIï¼ˆå•†ä¸šæ™ºèƒ½ï¼‰ï¼š**æ•°æ®å¯è§†åŒ–ï¼ŒæŠ¥è¡¨å¯è§†åŒ–ç³»ç»Ÿ

**ä¸»æµBIï¼š**

- å¸†è½¯BI https://www.finebi.com
- å°é©¬BI https://bi.zhls.qq.com
- PowerBI https://powerbi.microsoft.com/zh-cn 

**ä¼ ç»ŸBIï¼š**

https://chartcube.alipay.com

1. éœ€è¦äººå·¥ä¸Šä¼ æ•°æ®
2. éœ€è¦äººå·¥é€‰æ‹©æ•°æ®çš„è¡Œå’Œåˆ—è¿›è¡Œåˆ†æï¼ˆæ•°æ®åˆ†æå¸ˆï¼‰
3. éœ€è¦äººå·¥é€‰æ‹©å›¾è¡¨ç±»å‹ï¼ˆæ•°æ®åˆ†æå¸ˆï¼‰
4. ç”Ÿæˆå›¾è¡¨ï¼ˆä¿å­˜é…ç½®ï¼‰

**æ™ºèƒ½BIå¹³å°ï¼š**

1. ç”¨æˆ·ï¼ˆæ•°æ®åˆ†æè€…ï¼‰åªéœ€è¦å¯¼å…¥åŸå§‹æ•°æ®ï¼Œè¾“å…¥æƒ³è¦åˆ†æçš„ç›®æ ‡ï¼ˆæ¯”å¦‚â€å¸®æˆ‘åˆ†æä»¥ä¸‹ç½‘ç«™çš„ç”¨æˆ·å¢é•¿è¶‹åŠ¿â€œï¼‰ï¼Œå°±èƒ½åˆ©ç”¨AIè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç¬¦åˆè¦æ±‚çš„å›¾è¡¨ä»¥åŠç»“è®º
2. ä¸ä¼šæ•°æ®åˆ†æçš„ç”¨æˆ·ï¼Œä¹Ÿèƒ½é€šè¿‡è¾“å…¥ç›®æ ‡å¿«é€Ÿå®Œæˆæ•°æ®åˆ†æï¼Œå¤§å¹…èŠ‚çº¦äººåŠ›æˆæœ¬

## éœ€æ±‚åˆ†æ

1. æ™ºèƒ½åˆ†æï¼šç”¨æˆ·è¾“å…¥ç›®æ ‡ï¼ŒåŸå§‹æ•°æ®å’Œå…¶ä»–å‚æ•°ï¼ˆå¦‚å›¾è¡¨ç±»å‹ï¼‰ï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆå›¾è¡¨å’Œç»“è®º
2. å›¾è¡¨ç®¡ç†
3. å›¾è¡¨ç”Ÿæˆçš„å¼‚æ­¥åŒ–ï¼ˆæ¶ˆæ¯é˜Ÿåˆ— ï¼‰
4. å¯¹æ¥ AI 

## æ¶æ„å›¾

![image-20231030214212882](assets/image-20231030214212882.png)

## æŠ€æœ¯é€‰æ‹©

**å‰ç«¯ï¼š**

- React
- Ant Design Pro
- Umi
- ECharts å¯è§†åŒ–å¼€å‘åº“
- umi openapi ä»£ç ç”Ÿæˆï¼ˆè‡ªåŠ¨ç”Ÿæˆåç«¯è°ƒç”¨ä»£ç ï¼‰

**åç«¯ï¼š**

- Spring Bootï¼ˆä¸‡ç”¨ Java åç«¯é¡¹ç›®æ¨¡æ¿ï¼‰
- MySQL
- MyBatis Plus
- RabbitMQ
- AI èƒ½åŠ›ï¼ˆOpen AI æ¥å£å¼€å‘/ ä½¿ç”¨ç°æˆçš„ AI æ¥å£ï¼‰
- EasyExcelï¼ˆExcel çš„ä¸Šä¼ å’Œæ•°æ®çš„è§£æï¼‰
- Swagger + Knife4j
- Hutool

## è®¡åˆ’

**åˆå§‹åŒ–**

- å‰ç«¯
- åç«¯

**åç«¯**

- æ•°æ®åº“è¡¨è®¾è®¡
- è‡ªåŠ¨ç”Ÿæˆå¢åˆ æ”¹æŸ¥ä»£ç 
- å›¾è¡¨ç®¡ç†
- æ™ºèƒ½å›¾è¡¨åˆ†æ

**å‰ç«¯**

- è‡ªåŠ¨ç”Ÿæˆåç«¯è°ƒç”¨ä»£ç 
- ä¿®æ”¹requestErrorConfig

- ç™»å½•æ³¨å†Œé¡µé¢
- æ™ºèƒ½å›¾è¡¨åˆ†æé¡µé¢
- å›¾è¡¨ç®¡ç†é¡µé¢

## åˆå§‹åŒ–

### å‰ç«¯

#### åˆå§‹åŒ–

https://pro.ant.design/

1. åˆ›å»ºé¡¹ç›®

```sh
# ä½¿ç”¨ npmï¼Œ
npm i @ant-design/pro-cli -g
pro create luobi-frontend
```

![image-20231031101557449](assets/image-20231031101557449.png)

2. å®‰è£…ä¾èµ–

```
yarn
```

![image-20231031102623399](assets/image-20231031102623399.png)

3. å»é™¤å›½é™…åŒ–

![image-20231031105510481](assets/image-20231031105510481.png)

[ğŸ› [BUG\] æ‰§è¡Œåˆ é™¤å›½é™…åŒ–å‘½ä»¤æŠ¥é”™ Â· Issue #10452 Â· ant-design/ant-design-pro (github.com)](https://github.com/ant-design/ant-design-pro/issues/10452)

![image-20231031105637111](assets/image-20231031105637111.png)

```sh
yarn add eslint-config-prettier --dev yarn add eslint-plugin-unicorn --dev 
```

![image-20231031105714817](assets/image-20231031105714817.png)

![image-20231031105729743](assets/image-20231031105729743.png)

å†æ¬¡æ‰§è¡Œå»é™¤å›½é™…åŒ–å°±èƒ½æˆåŠŸäº†

![image-20231031105849430](assets/image-20231031105849430.png)

#### ç»“æ„ä»‹ç»

- .huskyï¼šæäº¤ä»£ç æ—¶ï¼Œæ£€æŸ¥æ˜¯å¦è§„èŒƒ
- config
  - config.tsï¼šæ ¸å¿ƒé…ç½®æ–‡ä»¶
  - defaultSettings.tsï¼šä¸»é¡µé¡µé¢çš„æ’ç‰ˆå’Œé¢œè‰²ç­‰è®¾ç½®
  - openapi.jsonï¼šåªæ˜¯ç¤ºä¾‹æ•°æ®ï¼Œæ— ç”¨å¯åˆ é™¤
  - proxy.tsï¼šä»£ç†
  - routes.tsï¼šè·¯ç”±
- mockï¼šæ¨¡æ‹Ÿæ•°æ®ï¼Œæ— ç”¨å¯åˆ é™¤
- public
  - iconsï¼šå›¾æ ‡logoï¼Œæ— ç”¨å¯åˆ é™¤
  - scriptsï¼šä¸çŸ¥é“
  - CNAMEï¼šä¸ç”¨ç®¡
  - favicon.icoï¼šç½‘ç«™å·¦ä¸Šè§’å°å›¾æ ‡ https://www.iconfont.cn
  - logo.svgï¼šæ›¿æ¢æˆè‡ªå·±çš„logohttps://www.iconfont.cn
  - pro_icon.svgï¼šæ— ç”¨åˆ é™¤
- src
  - .umiï¼šå¸¦ç‚¹çš„æ˜¯éšè—æ–‡ä»¶ï¼Œæ¡†æ¶è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¸ç”¨ç®¡
  - componentsï¼šéœ€è¦å¼€å‘çš„ç»„ä»¶
  - localesï¼šå›½é™…åŒ–ï¼Œæ— ç”¨å¯åˆ é™¤
  - pagesï¼šéœ€è¦å¼€å‘çš„é¡µé¢
    - User
      - Login
        - __snapshots__ï¼šå¤šä½™å¯åˆ é™¤
        - login.test.tsxï¼šå¤šä½™å¯åˆ é™¤
    - TableListï¼šæš‚æ—¶æœªç”¨åˆ°ï¼Œåˆ é™¤
  - services
    - ant-design-proï¼šæœ‰å¾ˆå¤šæ¡†æ¶è‡ªå®šä¹‰çš„å‡½æ•°å’Œç±»å‹ï¼Œä¸ç”¨åˆ ï¼Œå¯èƒ½ä¼šå¼•èµ·è¿é”æ•ˆåº”
    - luobiï¼šæˆ‘ä»¬è‡ªå·±ä½¿ç”¨openapiç”Ÿæˆçš„å‡½æ•°å’Œç±»å‹
    - swaggerï¼šæ— ç”¨å¯åˆ é™¤
  - access.tsï¼šæ§åˆ¶é¡µé¢è®¿é—®
  - app.tsxï¼šæ•´ä¸ªæ¡†æ¶çš„å…¥å£æ–‡ä»¶
  - global.lessï¼šå…¨å±€æ ·å¼
  - global.tsxï¼šå…¨å±€çš„jsæ–‡ä»¶ï¼Œä¸è¦åˆ æ”¹
  - manifest.jsonï¼šå¼€å‘appæˆ–H5ç½‘é¡µæ—¶æŒ‡å®šçš„é…ç½®ï¼šæ¯”å¦‚å£°æ˜é¡¹ç›®çš„åç§°ï¼Œå›¾æ ‡çš„å°ºå¯¸ï¼Œæ‰“åŒ…æ—¶ç”¨ã€‚å¯åˆ 
  - requestErrorConfigï¼šå‰ç«¯å‘è¯·æ±‚çš„ä¸€äº›é…ç½®ï¼Œæ¯”å¦‚è¯·æ±‚å“åº”æ‹¦æˆªå™¨ï¼Œè¯·æ±‚å‰ç¼€
  - service-workers.jsï¼šä¸ºäº†ä¼˜åŒ–ç¦»çº¿H5é¡µé¢çš„ä½“éªŒ
  - typings.d.tsï¼šä¸çŸ¥é“ï¼Œä¸èƒ½åˆ 
- testsï¼šæµ‹è¯•æ–‡ä»¶ï¼Œæ— ç”¨å¯åˆ é™¤
- typesï¼šæ— ç”¨å¯åˆ é™¤
- .editorconfigã€.eslintrc.jsã€.prettierrc.jsï¼šç”¨æ¥ä¿è¯å‰ç«¯ä»£ç è§„èŒƒ
- jest.config.tsï¼šå•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œä¸ç”¨UIæµ‹è¯•å¯åˆ é™¤
- jsconfig.jsonï¼šæ§åˆ¶ä»£ç è¯­æ³•
- README.mdï¼šé¡¹ç›®çš„ä»‹ç»æ–‡æ¡£

#### æ›¿æ¢logo

**favicon.icoï¼š**ç½‘ç«™å·¦ä¸Šè§’å°å›¾æ ‡ https://www.iconfont.cn

![image-20231031205626497](assets/image-20231031205626497.png)

![image-20231031205828170](assets/image-20231031205828170.png)

png è½¬favicon https://www.gaituba.com/favicon

![image-20231031210026473](assets/image-20231031210026473.png)

**logo.svgï¼š**æ›¿æ¢æˆè‡ªå·±çš„logohttps://www.iconfont.cn

![image-20231031205304201](assets/image-20231031205304201.png)

![image-20231031205328579](assets/image-20231031205328579.png)

![image-20231031210249195](assets/image-20231031210249195.png)

#### prettierç¾åŒ–é…ç½®

![image-20231031212517690](assets/image-20231031212517690.png)

#### æ›¿æ¢ç½‘ç«™æ ‡é¢˜

å…¨å±€æ›¿æ¢ Ant Design Pro å’Œ Ant Design

![image-20231031213130067](assets/image-20231031213130067.png)

![image-20231031213338025](assets/image-20231031213338025.png)

#### æ›¿æ¢åº•éƒ¨çš„ç‰ˆæƒä¿¡æ¯

ç›´æ¥æœç´¢åº•éƒ¨å…³é”®å­—ï¼Œå»å¯¹åº”æ–‡ä»¶ä¿®æ”¹

![image-20231031214414293](assets/image-20231031214414293.png)

### åç«¯

1. ä½¿ç”¨åç«¯é¡¹ç›®æ¨¡æ¿

å¤åˆ¶æ¨¡æ¿ï¼Œä¿®æ”¹ç›®å½•åä¸ºé¡¹ç›®å

2. è¿æ¥æ•°æ®åº“

   ![image-20231031113006757](assets/image-20231031113006757.png)

3. ä¿®æ”¹æ•°æ®åº“å

![image-20231031113312177](assets/image-20231031113312177.png)

4. ä¿®æ”¹é¡¹ç›®å

![image-20231031113526512](assets/image-20231031113526512.png)

![image-20231031113636977](assets/image-20231031113636977.png)

5. å¼€å¯åˆ†å¸ƒå¼session

![image-20231031114027856](assets/image-20231031114027856.png)

![image-20231031114048256](assets/image-20231031114048256.png)

6. ä¿®æ”¹ç«¯å£

![image-20231031114227436](assets/image-20231031114227436.png)

7. å¯åŠ¨å¹¶è®¿é—®æ¥å£æ–‡æ¡£

![image-20231031114401762](assets/image-20231031114401762.png)

## åç«¯

### æ•°æ®åº“è¡¨è®¾è®¡

**ç”¨æˆ·è¡¨ï¼š**

```sql
create table if not exists user
(
    id           bigint auto_increment comment 'id' primary key,
    userAccount  varchar(256)                           not null comment 'è´¦å·',
    userPassword varchar(512)                           not null comment 'å¯†ç ',
    userName     varchar(256)                           null comment 'ç”¨æˆ·æ˜µç§°',
    userAvatar   varchar(1024)                          null comment 'ç”¨æˆ·å¤´åƒ',
    userProfile  varchar(512)                           null comment 'ç”¨æˆ·ç®€ä»‹',
    userRole     varchar(256) default 'user'            not null comment 'ç”¨æˆ·è§’è‰²ï¼šuser/admin/ban',
    gender       tinyint                                null comment 'æ€§åˆ«',
    createTime   datetime     default CURRENT_TIMESTAMP not null comment 'åˆ›å»ºæ—¶é—´',
    updateTime   datetime     default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment 'æ›´æ–°æ—¶é—´',
    isDelete     tinyint      default 0                 not null comment 'æ˜¯å¦åˆ é™¤',
    index idx_userAccount (userAccount)
) comment 'ç”¨æˆ·' collate = utf8mb4_unicode_ci;
```

**å›¾è¡¨ä¿¡æ¯è¡¨ï¼š**

```sql
-- å›¾è¡¨ä¿¡æ¯è¡¨
create table if not exists chart
(
    id         bigint auto_increment comment 'id' primary key,
    goal       text                               null comment 'åˆ†æç›®æ ‡',
    rawData    text                               null comment 'åŸå§‹æ•°æ®',
    chartType  varchar(128)                       null comment 'å›¾è¡¨ç±»å‹',
    chartName  varchar(128)                       null comment 'å›¾è¡¨åç§°',
    genChart   text                               null comment 'AIç”Ÿæˆçš„å›¾è¡¨æ•°æ®',
    genSummary text                               null comment 'AIç”Ÿæˆçš„åˆ†ææ€»ç»“',
    userId     bigint                             null comment 'åˆ›å»ºäººid',
    createTime datetime default CURRENT_TIMESTAMP not null comment 'åˆ›å»ºæ—¶é—´',
    updateTime datetime default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment 'æ›´æ–°æ—¶é—´',
    isDelete   tinyint  default 0                 not null comment 'æ˜¯å¦åˆ é™¤'
) comment 'å›¾è¡¨ä¿¡æ¯' collate = utf8mb4_unicode_ci;
```

### è‡ªåŠ¨ç”Ÿæˆå¢åˆ æ”¹æŸ¥ä»£ç 

![image-20231031141404931](assets/image-20231031141404931.png)

![image-20231031141439155](assets/image-20231031141439155.png)

![image-20231031141503920](assets/image-20231031141503920.png)

1. ç”Ÿæˆçš„UserServiceå’ŒUserServiceImplä¸ç”¨æ›¿æ¢åŸæ¥çš„

2. ä¿®æ”¹å­—æ®µçš„æ³¨è§£

   ![image-20231031142728852](assets/image-20231031142728852.png)

   ![image-20231031142744734](assets/image-20231031142744734.png)

   ![image-20231031142801435](assets/image-20231031142801435.png)

   ![image-20231031142813281](assets/image-20231031142813281.png)

3. åˆ æ‰UserServiceå’ŒUserServiceImplå’ŒUserControllerä¸­ç”¨ä¸åˆ°çš„æ–¹æ³•

   ![image-20231031143327862](assets/image-20231031143327862.png)

   ![image-20231031143356282](assets/image-20231031143356282.png)

   ![image-20231031143538773](assets/image-20231031143538773.png)

4. åˆ æ‰å¾®ä¿¡å…¬ä¼—å·å¼€å‘åŒ…

   ![image-20231031143643260](assets/image-20231031143643260.png)

5. åˆ æ‰WxMPController

   ![image-20231031143826847](assets/image-20231031143826847.png)

### å›¾è¡¨ç®¡ç†

1. å¤åˆ¶PostControllerä¿®æ”¹æˆChartController

   ![image-20231031145120748](assets/image-20231031145120748.png)

   ![image-20231031145230166](assets/image-20231031145230166.png)

   ![image-20231031145445986](assets/image-20231031145445986.png)  

2. åˆ›å»ºå…³äºChartçš„DTOç±»

   ![image-20231031153057014](assets/image-20231031153057014.png)

3. å‰ªè£ChartControllerå¹¶ä¸ºChartServiceæä¾›getQueryWrapperæ–¹æ³•

   ```java
   /**
    * @author è½æ¨±çš„æ‚”æ¨
    * @description é’ˆå¯¹è¡¨ã€chart(å›¾è¡¨ä¿¡æ¯è¡¨)ã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°
    * @createDate 2023-10-31 14:16:29
    */
   @Service
   public class ChartServiceImpl extends ServiceImpl<ChartMapper, Chart>
           implements ChartService {
   
       /**
        * è·å–æŸ¥è¯¢åŒ…è£…ç±»
        *
        * @param chartQueryRequest
        * @return
        */
       @Override
       public QueryWrapper<Chart> getQueryWrapper(ChartQueryRequest chartQueryRequest) {
           QueryWrapper<Chart> queryWrapper = new QueryWrapper<>();
           if (chartQueryRequest == null) {
               return queryWrapper;
           }
           Long id = chartQueryRequest.getId();
           Long userId = chartQueryRequest.getUserId();
           String goal = chartQueryRequest.getGoal();
           String chartType = chartQueryRequest.getChartType();
           String chartName = chartQueryRequest.getChartName();
           String sortField = chartQueryRequest.getSortField();
           String sortOrder = chartQueryRequest.getSortOrder();
           // æ‹¼æ¥æŸ¥è¯¢æ¡ä»¶
           queryWrapper.eq(id != null && id > 0, "id", id);
           queryWrapper.eq(ObjectUtils.isNotEmpty(userId), "userId", userId);
           queryWrapper.like(StringUtils.isNotBlank(goal), "goal", goal);
           queryWrapper.like(StringUtils.isNotBlank(chartType), "chartType", chartType);
           queryWrapper.like(StringUtils.isNotBlank(chartName), "chartName", chartName);
           queryWrapper.eq("isDelete", false);
           queryWrapper.orderBy(SqlUtils.validSortField(sortField), sortOrder.equals(CommonConstant.SORT_ORDER_ASC),
                   sortField);
           return queryWrapper;
       }
   }
   ```


### æ™ºèƒ½å›¾è¡¨åˆ†æ

#### **AIè°ƒç”¨çš„å‡ ç§æ–¹å¼**

**1ã€ç›´æ¥è°ƒç”¨ OpenAI æˆ–è€…å…¶ä»– AI åŸå§‹å¤§æ¨¡å‹å®˜ç½‘çš„æ¥å£**

å®˜æ–¹æ–‡æ¡£ï¼šhttps://platform.openai.com/docs/api-reference

ä¼˜ç‚¹ï¼šä¸ç»å°è£…ï¼Œæœ€çµæ´»ï¼Œæœ€åŸå§‹

ç¼ºç‚¹ï¼šè¦é’±

ä½¿ç”¨æ–¹å¼ï¼š

1ï¼‰åœ¨è¯·æ±‚å¤´ä¸­æŒ‡å®šOPENAI_API_KEY

```
Authorization: Bearer OPENAI_API_KEY
```

2ï¼‰æ‰¾åˆ°è¦ä½¿ç”¨çš„æ¥å£ https://platform.openai.com/docs/api-reference/chat/create

3ï¼‰æŒ‰ç…§æ¥å£æ–‡æ¡£çš„ç¤ºä¾‹ï¼Œæ„é€  HTTP è¯·æ±‚

```
curl https://api.openai.com/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -d '{
    "model": "gpt-3.5-turbo",
    "messages": [
      {
        "role": "system",
        "content": "You are a helpful assistant."
      },
      {
        "role": "user",
        "content": "Hello!"
      }
    ]
  }'

```

```java
import cn.hutool.http.HttpRequest;
import cn.hutool.json.JSONUtil;

import java.util.*;

public class OpenAIAPI {
    public static void main(String[] args) {
        String url = "https://api.openai.com/v1/chat/completions";

        LinkedHashMap<String,Object> map =new LinkedHashMap<>();
        List<LinkedHashMap<String,Object>> messageList =new ArrayList<>();

        LinkedHashMap<String,Object> messageMap =new LinkedHashMap<>();
        messageMap.put("role","system");
        messageMap.put("content","You are a helpful assistant.");

        messageList.add(messageMap);

        map.put("model","gpt-3.5-turbo");
        map.put("message",messageList);

        String requestBody = JSONUtil.toJsonStr(map);
        HttpRequest.post(url)
                .header("Authorization","Bearer OPENAI_API_KEY")
                .header("Content-Type","application/json")
                .body(requestBody)
                .execute()
                .body();
    }
}
```

![image-20231102104638957](assets/image-20231102104638957.png)

**2ã€ä½¿ç”¨äº‘æœåŠ¡å•†æä¾›çš„ï¼Œå°è£…åçš„ AI æ¥å£**

æ¯”å¦‚ï¼šAzureäº‘

ä¼˜ç‚¹ï¼šæœ¬åœ°èƒ½ç”¨

ç¼ºç‚¹ï¼šè¦é’±

**3ã€åˆ©ç”¨é±¼èªæ˜ AI æä¾›çš„å¼€æ”¾ SDK** https://github.com/liyupi/yucongming-java-sdk

ä¼˜ç‚¹ï¼šç›®å‰ä¸è¦é’±ï¼Œæœ‰å¾ˆå¤šç°æˆçš„æ¨¡å‹

ç¼ºç‚¹ï¼šä¸å¤Ÿçµæ´»

1ï¼‰å¼•å…¥ä¾èµ–

```xml
<dependency>
    <groupId>com.yucongming</groupId>
    <artifactId>yucongming-java-sdk</artifactId>
    <version>0.0.3</version>
</dependency>
```

2ï¼‰ä¿®æ”¹é…ç½®

```yml
yuapi:
  client:
    access-key: c34re67to6v7yu2qf4nzawr8ultmy0a2
    secret-key: i6cnztxw6scfmrtykndjd5apitqcrejv
```

3ï¼‰è°ƒç”¨æ¥å£

```java
@Component
public class AIManager {
    @Resource
    private YuCongMingClient yuCongMingClient;

    /**
     *
     * @param modelId
     * @param message
     * @return
     */
    public String doChat(long modelId,String message){
        DevChatRequest devChatRequest = new DevChatRequest();
        devChatRequest.setModelId(modelId);
        devChatRequest.setMessage(message);
        BaseResponse<DevChatResponse> response = yuCongMingClient.doChat(devChatRequest);
        if (response==null){
            throw new BusinessException(ErrorCode.SYSTEM_ERROR,"AIå“åº”é”™è¯¯");
        }
        return response.getData().getContent();
    }
}
```

#### ä¸šåŠ¡æµç¨‹

1. æ ¡éªŒå‚æ•°
2. å‹ç¼©åŸå§‹æ•°æ®ï¼šAIæ¥å£æ™®ééƒ½æœ‰è¾“å…¥å­—æ•°é™åˆ¶ï¼Œå°½å¯èƒ½å‹ç¼©æ•°æ®ï¼Œèƒ½å¤Ÿå¤šä¼ ä¸€äº›æ•°æ®
3. æ„é€ ç”¨æˆ·è¯·æ±‚ï¼ˆåˆ†æç›®æ ‡ï¼Œå›¾è¡¨åç§°ï¼Œå›¾è¡¨ç±»å‹ï¼Œcsvæ•°æ®ï¼‰
4. è°ƒç”¨é±¼èªæ˜SDKï¼Œå¾—åˆ°å“åº”ï¼ˆå›¾è¡¨ä¿¡æ¯ï¼Œç»“è®ºæ–‡æœ¬ï¼‰
5. ä»AIå“åº”ç»“æœä¸­ï¼Œå–å‡ºéœ€è¦çš„æ•°æ®ï¼ˆå›¾è¡¨ä¿¡æ¯ï¼šEcharts V5 çš„ options é…ç½®å¯¹è±¡jsä»£ç ï¼›ç»“è®ºæ–‡æœ¬ï¼‰
6. ä¿å­˜åˆ°æ•°æ®åº“
7. è¿”å›å›¾è¡¨ä¿¡æ¯ï¼Œç»“è®ºæ–‡æœ¬ï¼Œå›¾è¡¨IDç»™å‰ç«¯

**æ¨¡å‹é¢„è®¾**

```
ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æå¸ˆå’Œå‰ç«¯å¼€å‘ä¸“å®¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šæŒ‰ç…§ä»¥ä¸‹å›ºå®šæ ¼å¼ç»™ä½ æä¾›å†…å®¹ï¼š
åˆ†æéœ€æ±‚ï¼š
{æ•°æ®åˆ†æçš„éœ€æ±‚æˆ–è€…ç›®æ ‡}
åŸå§‹æ•°æ®ï¼š
{csvæ ¼å¼çš„åŸå§‹æ•°æ®ï¼Œç”¨,ä½œä¸ºåˆ†éš”ç¬¦}
è¯·æ ¹æ®è¿™ä¸¤éƒ¨åˆ†å†…å®¹ï¼ŒæŒ‰ç…§ä»¥ä¸‹æŒ‡å®šæ ¼å¼ç”Ÿæˆå†…å®¹ï¼ˆæ­¤å¤–ä¸è¦è¾“å‡ºä»»ä½•å¤šä½™çš„å¼€å¤´ã€ç»“å°¾ã€æ³¨é‡Šï¼‰
ã€ã€ã€ã€ã€
{å‰ç«¯ Echarts V5 çš„ option é…ç½®å¯¹è±¡jsonä»£ç ï¼Œåˆç†åœ°å°†æ•°æ®è¿›è¡Œå¯è§†åŒ–ï¼Œä¸è¦ç”Ÿæˆä»»ä½•å¤šä½™çš„å†…å®¹ï¼Œæ¯”å¦‚æ³¨é‡Š}
ã€ã€ã€ã€ã€
{æ˜ç¡®çš„æ•°æ®åˆ†æç»“è®ºã€è¶Šè¯¦ç»†è¶Šå¥½ï¼Œä¸è¦ç”Ÿæˆå¤šä½™çš„æ³¨é‡Š}
```

![image-20231102134925868](assets/image-20231102134925868.png)

```java
@Data
public class GenChartRequest implements Serializable {

    /**
     * åˆ†æç›®æ ‡
     */
    private String goal;

    /**
     * å›¾è¡¨ç±»å‹
     */
    private String chartType;

    /**
     * å›¾è¡¨åç§°
     */
    private String chartName;

    private static final long serialVersionUID = 1L;
}
```

```java
/**
 * BIçš„è¿”å›ç»“æœ
 */
@Data
public class BIResponse {
    private String genChart;

    private String genSummary;

    private Long chartId;
}
```

```java
@Slf4j
public class ExcelUtils {
    public static String excelToCsv(MultipartFile multipartFile) {
        /*File file = null;
        try {
            file = ResourceUtils.getFile("classpath:ç½‘ç«™æ•°æ®.xlsx");
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }*/
        // 1. ä»æ–‡ä»¶è¯»å–å‡ºæ•°æ®
        List<Map<Integer, String>> list = null;
        try {
            list = EasyExcel.read(multipartFile.getInputStream())
                    .excelType(ExcelTypeEnum.XLSX)
                    .sheet()
                    .headRowNumber(0)
                    .doReadSync();
        } catch (IOException e) {
            log.error("è¡¨æ ¼å¤„ç†é”™è¯¯",e);
        }
        if (CollectionUtil.isEmpty(list)) {
            return "";
        }
        // 2. è½¬æ¢ä¸ºcsv
        StringBuilder stringBuilder = new StringBuilder();
        // 2.1 è¯»å–è¡¨å¤´
        LinkedHashMap<Integer, String> headerMap = (LinkedHashMap) list.get(0);
        List<String> headerList =headerMap.values().stream().filter(ObjectUtils::isNotEmpty).collect(Collectors.toList());
        stringBuilder.append(StringUtils.join(headerList, ",")).append("\n");
        // 2.1 è¯»å–æ•°æ®è¡Œ
        for (int i = 1; i < list.size(); i++) {
            LinkedHashMap<Integer, String> dataMap = (LinkedHashMap) list.get(i);
            List<String> dataList = dataMap.values().stream().filter(ObjectUtils::isNotEmpty).collect(Collectors.toList());
            stringBuilder.append(StringUtils.join(dataList, ",")).append("\n");
        }
        return stringBuilder.toString();
    }
}
```

```java
/**
 * æ™ºèƒ½åˆ†æ
 *
 * @param multipartFile
 * @param genChartRequest
 * @param request
 * @return
 */
@PostMapping("/gen")
public BaseResponse<BIResponse> genChartByAI(@RequestPart("file") MultipartFile multipartFile,
                                             GenChartRequest genChartRequest, HttpServletRequest request) {
    String goal = genChartRequest.getGoal();
    String chartType = genChartRequest.getChartType();
    String chartName = genChartRequest.getChartName();
    // æ‹¼æ¥åˆ†æç›®æ ‡
    if (StringUtils.isNotBlank(chartType)) {
        goal = goal + "ï¼Œè¯·ä½¿ç”¨" + chartType;
    }
    // æ ¡éªŒå‚æ•°
    ThrowUtils.throwIf(StringUtils.isBlank(goal), ErrorCode.PARAMS_ERROR, "åˆ†æç›®æ ‡ä¸ºç©º");
    ThrowUtils.throwIf(StringUtils.isNotBlank(chartName) && chartName.length() > 128, ErrorCode.PARAMS_ERROR, "å›¾è¡¨åç§°è¿‡é•¿");
    // è·å–ç™»å½•ç”¨æˆ·
    User loginUser = userService.getLoginUser(request);
    // å‹ç¼©åŸå§‹æ•°æ®
    String data = ExcelUtils.excelToCsv(multipartFile);
    // æ„é€ ç”¨æˆ·è¯·æ±‚ï¼ˆåˆ†æç›®æ ‡ï¼Œå›¾è¡¨åç§°ï¼Œå›¾è¡¨ç±»å‹ï¼Œcsvæ•°æ®ï¼‰
    StringBuilder userInput = new StringBuilder();
    userInput.append("åˆ†æéœ€æ±‚ï¼š").append("\n");
    userInput.append(goal).append("\n");
    userInput.append("åŸå§‹æ•°æ®ï¼š").append("\n");
    userInput.append(data).append("\n");
    // è°ƒç”¨é±¼èªæ˜SDKï¼Œå¾—åˆ°å“åº”
    long biModelId = 1719916921023344642L;
    String answer = aiManager.doChat(biModelId, userInput.toString());
    // ä»AIå“åº”ç»“æœä¸­ï¼Œå–å‡ºéœ€è¦çš„æ•°æ®
    String[] splits = answer.split("ã€ã€ã€ã€ã€");
    if (splits.length < 3) {
        throw new BusinessException(ErrorCode.SYSTEM_ERROR, "AIç”Ÿæˆé”™è¯¯");
    }
    String genChart = splits[1].trim();
    String genSummary = splits[2].trim();
    // æ’å…¥æ•°æ®åº“
    Chart chart = new Chart();
    chart.setGoal(goal);
    chart.setRawData(data);
    chart.setChartType(chartType);
    chart.setChartName(chartName);
    chart.setGenChart(genChart);
    chart.setGenSummary(genSummary);
    chart.setUserId(loginUser.getId());
    boolean save = chartService.save(chart);
    ThrowUtils.throwIf(!save, ErrorCode.SYSTEM_ERROR, "å›¾è¡¨ä¿å­˜å¤±è´¥");
    // è¿”å›ç»™å‰ç«¯
    BIResponse biResponse = new BIResponse();
    biResponse.setGenChart(genChart);
    biResponse.setGenSummary(genSummary);
    biResponse.setChartId(chart.getId());
    return ResultUtils.success(biResponse);
}
```

![image-20231102135109277](assets/image-20231102135109277.png)

## å‰ç«¯

### è‡ªåŠ¨ç”Ÿæˆåç«¯è°ƒç”¨ä»£ç 

![image-20231031161114725](assets/image-20231031161114725.png)

![image-20231031161044255](assets/image-20231031161044255.png)

![image-20231031161225991](assets/image-20231031161225991.png)

![image-20231031160739020](assets/image-20231031160739020.png)

### ä¿®æ”¹requestErrorConfig

![image-20231101104428242](assets/image-20231101104428242.png)

![image-20231101104452851](assets/image-20231101104452851.png)

![image-20231101105205945](assets/image-20231101105205945.png)

![image-20231101105346669](assets/image-20231101105346669.png)

![image-20231101105418575](assets/image-20231101105418575.png)

### ç™»å½•æ³¨å†Œé¡µé¢

#### ç™»å½•é¡µé¢

1. **ä¿®æ”¹é¡µé¢**

![image-20231101093859849](assets/image-20231101093859849.png)

![image-20231101094604170](assets/image-20231101094604170.png)

![image-20231101094805356](assets/image-20231101094805356.png)

![image-20231101095024190](assets/image-20231101095024190.png)

![image-20231101095351698](assets/image-20231101095351698.png)

![image-20231101095905454](assets/image-20231101095905454.png)

![image-20231101100628266](assets/image-20231101100628266.png)

![image-20231101100753049](assets/image-20231101100753049.png)

![image-20231101100921671](assets/image-20231101100921671.png)

![image-20231101102635469](assets/image-20231101102635469.png)

![image-20231101102712922](assets/image-20231101102712922.png)

![image-20231101111107730](assets/image-20231101111107730.png)

2. **å‘åç«¯å‘èµ·ç™»å½•è¯·æ±‚**

![image-20231101101745533](assets/image-20231101101745533.png)

[åœ¨ant-designä¸­å¦‚ä½•åˆ©ç”¨ä»£ç è‡ªåŠ¨åˆ·æ–°å½“å‰é¡µé¢_antd proä¸­é¡µé¢åˆ·æ–°çš„api-CSDNåšå®¢](https://blog.csdn.net/qq_40372395/article/details/80893453)

![image-20231101141243964](assets/image-20231101141243964.png)

![image-20231101105748685](assets/image-20231101105748685.png)

3. **ä¿®æ”¹app.tsxæ–‡ä»¶**

![image-20231101110537183](assets/image-20231101110537183.png)

![image-20231101110613918](assets/image-20231101110613918.png)

![image-20231101111152663](assets/image-20231101111152663.png)

![image-20231101134723132](assets/image-20231101134723132.png)

#### æ³¨å†Œé¡µé¢

å¤åˆ¶ç™»é™†é¡µé¢ä¿®æ”¹ï¼Œå†æ·»åŠ æ³¨å†Œé¡µé¢çš„è·¯ç”±

![image-20231101134403032](assets/image-20231101134403032.png)

![image-20231101134739225](assets/image-20231101134739225.png)

#### é€€å‡ºç™»å½•

![image-20231101140309845](assets/image-20231101140309845.png)

![image-20231101141545088](assets/image-20231101141545088.png)

![image-20231101140401063](assets/image-20231101140401063.png)

![image-20231101140432402](assets/image-20231101140432402.png)

![image-20231101140559979](assets/image-20231101140559979.png)

### æ™ºèƒ½å›¾è¡¨åˆ†æé¡µé¢

1. ç”¨æˆ·è¾“å…¥
   1. åˆ†æç›®æ ‡
   2. ä¸Šä¼ åŸå§‹æ•°æ®ï¼ˆexcelï¼‰
   3. æ›´ç²¾ç»†åŒ–çš„æ§åˆ¶å›¾è¡¨ï¼šæ¯”å¦‚å›¾è¡¨ç±»å‹ï¼Œå›¾è¡¨åç§°ç­‰
2. å±•ç¤º
   1. å±•ç¤ºä»åç«¯è·å¾—çš„å›¾è¡¨å’Œç»“è®º

**1ã€è‡ªåŠ¨ç”Ÿæˆåç«¯è°ƒç”¨ä»£ç **

**2ã€åˆ›å»ºé¡µé¢**

![image-20231103152845702](assets/image-20231103152845702.png)

**3ã€æ·»åŠ è·¯ç”±**

![image-20231103153006971](assets/image-20231103153006971.png)

**4ã€ç”¨æˆ·è¾“å…¥**

1. é€‰æ‹©ç»„ä»¶

![image-20231103145354640](assets/image-20231103145354640.png)

![image-20231103145455990](assets/image-20231103145455990.png)

![image-20231103145518854](assets/image-20231103145518854.png)

2. å¼•å…¥ç»„ä»¶

![image-20231103181144202](assets/image-20231103181144202.png)

![image-20231102203513905](assets/image-20231102203513905.png)

![image-20231102203553926](assets/image-20231102203553926.png)

![image-20231102203626446](assets/image-20231102203626446.png)

![image-20231102203701102](assets/image-20231102203701102.png)

![image-20231102203751293](assets/image-20231102203751293.png)

**4ã€å›¾è¡¨å±•ç¤º** https://github.com/hustcc/echarts-for-react  https://git.hust.cc/echarts-for-react/

![image-20231102203834196](assets/image-20231102203834196.png)

![image-20231102202549740](assets/image-20231102202549740.png)

### ä¸ªäººå›¾è¡¨é¡µé¢

**1.åˆ›å»ºé¡µé¢**

![image-20231103155522380](assets/image-20231103155522380.png)

**2ã€æ·»åŠ è·¯ç”±**

![image-20231103153629589](assets/image-20231103153629589.png)

**3ã€è·å–æ•°æ®ï¼Œå®šä¹‰ state å˜é‡æ¥å­˜å‚¨æ•°æ®ï¼Œç”¨äºç»™é¡µé¢å±•ç¤º**

![image-20231103172437291](assets/image-20231103172437291.png)

![image-20231103162350923](assets/image-20231103162350923.png)

![image-20231103161951719](assets/image-20231103161951719.png)

**4ã€é€‰æ‹©ç»„ä»¶**

![image-20231103162714889](assets/image-20231103162714889.png)

**5ã€å¼•å…¥ç»„ä»¶**

![image-20231103172159876](assets/image-20231103172159876.png)

![image-20231103172331765](assets/image-20231103172331765.png)

![image-20231103173125126](assets/image-20231103173125126.png)

**6ã€æ·»åŠ åˆ†é¡µ**

![image-20231103174145626](assets/image-20231103174145626.png)

**7ã€æ·»åŠ æœç´¢æ¡†**

![image-20231103175128062](assets/image-20231103175128062.png)

![image-20231103175103464](assets/image-20231103175103464.png)

**8ã€è®¾ç½®loading**

![image-20231103180537559](assets/image-20231103180537559.png)

![image-20231103180521767](assets/image-20231103180521767.png)

![image-20231103180604913](assets/image-20231103180604913.png)

![image-20231103180620196](assets/image-20231103180620196.png)

**9ã€åŸå­åŒ–æ ·å¼**

![image-20231103180738768](assets/image-20231103180738768.png)

![image-20231103180802775](assets/image-20231103180802775.png)

**10ã€å±•ç¤º**

![image-20231103181323718](assets/image-20231103181323718.png)

**11ã€æ‰©å±•ç‚¹**

æ”¯æŒç”¨æˆ·æŸ¥çœ‹åŸå§‹æ•°æ®

æ”¯æŒè·³è½¬åˆ°iå›¾è¡¨ç¼–è¾‘é¡µï¼Œå»ç¼–è¾‘å›¾è¡¨

## Ant Design Proè¸©å‘

1. é¡µé¢å¦‚æœä¸€ç›´åŠ è½½ï¼Œåˆ æ‰no de_modulesï¼Œé‡æ–°å®‰è£…ä¾èµ–

2. nodejsç‰ˆæœ¬å»ºè®®16

3. æƒé™ä¸å¤Ÿå°±åˆ‡ç®¡ç†å‘˜

4. æäº¤ä»£ç 

   ```
   git commit --no-verify -m 'your message'
   ```


## Windowså‘½ä»¤

```sh
#æŸ¥çœ‹Windows Hyper-V è™šæ‹ŸåŒ–å¹³å°å ç”¨äº†å“ªäº›èŒƒå›´å†…çš„ç«¯å£
netsh interface ipv4 show excludedportrange protocol=tcp
```

![image-20231031202852991](assets/image-20231031202852991.png)
